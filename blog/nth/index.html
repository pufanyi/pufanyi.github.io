<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="EPlMR3j8io1DcEScvNJuBPxLxCTSnNUjNwF4ZBhRO-I"> <meta name="msvalidate.01" content=""> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Linear Time (Worst Case) Nth-Element Algorithm | Fanyi Pu </title> <meta name="author" content="Fanyi Pu"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="Fanyi, Fanyi Pu, 濮凡轶"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?16404ec2cd2689e8d0f38f73fe0d38f9"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/avatar_very_small.webp?3828c08bd9576f9a024f464411e622b9"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://pufanyi.github.io/blog/nth/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Fanyi</span> Pu </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="https://scholar.google.com/citations?user=58tv6skAAAAJ" rel="external nofollow noopener" target="_blank">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/oi-blog/">oi-blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/resume/resume.pdf">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Linear Time (Worst Case) Nth-Element Algorithm</h1> <p class="post-meta"> Created in January 22, 2023 </p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/algorithm"> <i class="fa-solid fa-hashtag fa-sm"></i> algorithm</a>   <a href="/blog/tag/divide-and-conquer"> <i class="fa-solid fa-hashtag fa-sm"></i> divide and conquer</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>看到一个有趣的算法，能在最坏时间复杂度 \(\mathcal{O}(n)\) 内求出序列第 \(k\) 小。</p> <p>首先如果是期望线性的话，应该是非常简单的，就是我们直接使用快速排序的分治思想，随机选一个数作为 pivot，把比她小的放前面，比她大的放后面，于是就形成了左右两边，紧接着考虑左边的 size 是否小于 \(k\) 进行分治。</p> <p>但我们需要的是确定性算法。</p> <p>首先我们保证每个数是不相同的，这很好保证，只要开个 <code class="language-plaintext highlighter-rouge">pair</code>，在每个数后面附上一个 <code class="language-plaintext highlighter-rouge">index</code> 以双关键字比较即可。</p> <p>现在有一个非常有趣的想法，就是我们用一种方法来找到一个 pivot，让这个 pivot 比较居中。我们考虑将序列按照每五个切成片，这样的话如果是一个长度为 \(n\) 的序列，就会被切成 \(\left\lceil \frac{n}{5}\right\rceil\) 片，每片至多 \(5\) 个数，然后我们对这 \(5\) 个数取中位数，并将其提取出来，得到一个新的序列。这样这个新的序列的长度为 \(\left\lceil\frac{n}{5}\right\rceil\)。然后我们递归地求出这个序列的中位数（也就是该序列的第 \(\left\lfloor\frac{\left\lceil\frac{n}{5}\right\rceil}{2}\right\rfloor\) 小值，这也是一个 \(k\) 小值问题）。然后将该数作为 pivot 进行分治。</p> <p>我们考虑这个 pivot 的性质。考虑到此时计算起来比较麻烦，又考虑到这是一个分治算法，我们可以在 \(n\le 100\) 的时候直接采用排序，不影响复杂度。而在 \(n\) 比较大的时候，为了方便计算，我们在计算中忽略底和顶、少数加减常数以及脚块对复杂度的影响。假设这个 pivot 的值是 \(p\)，那么由于她是每个切片的中位数的中位数，也就是说，至少有 \(\frac{\frac{n}{5}}{2}=\frac{n}{10}\) 个切片的中位数比她小，\(\frac{n}{10}\) 个切片的中位数比她大。而在这些切片中，考虑到每个切片都有两个数大于中位数，两个数小于中位数，因此至少有 \(\frac{n}{5}\) 个非切片中位数的数大于和小于 pivot。也就是说，有 \(\frac{n}{10} + \frac{n}{5}=\frac{3}{10}n\) 个数大于和小于 pivot。那么分治时，不管是大于还是小于 \(k\)，一定是有 \(\frac{3}{10}n\) 个数是会被删掉的。也就是说，每次递归只会留下 \(\frac{7}{10}n\) 个数。</p> <p>这样复杂度就是：</p> \[T(n)=T\left(\frac{n}{5}\right) + T\left(\frac{7}{10}n\right) + \mathcal{O}(n)\] <p>我们用第二数学归纳法证明 \(T(n)=\mathcal{O}(n)\)。我们假设 \(\exists c\in\mathbb{N}, \forall k&lt;n, T(k)\le c\cdot k\)。归纳基础显然。</p> \[\begin{aligned} T(n)&amp;=T\left(\frac{n}{5}\right) + T\left(\frac{7}{10}n\right) + \mathcal{O}(n)\\ &amp;\le c\cdot\frac{n}{5} + c\cdot \frac{7}{10}n+\mathcal{O}(n)\\ &amp;\le c\cdot\frac{9}{10}n + \mathcal{O}(n) \end{aligned}\] <p>当 \(c\) 足够大到 \(\frac{c}{10}\) 大于等式中 \(\mathcal{O}(n)\) 的系数时，\(T(n)\le c\cdot n\)。</p> <p>因此，该算法复杂度为线性。</p> <p>前几天刚开始学 <code class="language-plaintext highlighter-rouge">java</code>，那就拿 <code class="language-plaintext highlighter-rouge">java</code> 来练练手。</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.LinkedList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Nth</span> <span class="o">{</span>
    <span class="cm">/**
     * Integers with a subscript, to make sure all numbers
     * in the array are different.
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">DistinctNumber</span> <span class="kd">implements</span> <span class="nc">Comparable</span><span class="o">&lt;</span><span class="nc">DistinctNumber</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">number</span><span class="o">,</span> <span class="n">index</span><span class="o">;</span>

        <span class="cm">/**
         * @param _number the value of the number.
         * @param _index  the index of the number in the array.
         */</span>
        <span class="kd">public</span> <span class="nf">DistinctNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">_number</span><span class="o">,</span> <span class="kt">int</span> <span class="n">_index</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">number</span> <span class="o">=</span> <span class="n">_number</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">index</span> <span class="o">=</span> <span class="n">_index</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="cm">/**
         * @return the value of the number.
         */</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">valueOf</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">number</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="cm">/**
         * Compare {@code this} and {@code b}. If the value of the two are the
         * same, compare the index.
         *
         * @param b the object to be compared.
         * @return an integer, if {@code x &lt; y} then {@code x.compareTo(y)
         * &lt; 0}, if {@code x &gt; y} then {@code x.compare(y) &gt; 0}, if {@code
         * x = y} then {@code x.compare(y) = 0}.
         */</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="nc">DistinctNumber</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">number</span> <span class="o">!=</span> <span class="n">b</span><span class="o">.</span><span class="na">number</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">number</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="na">number</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">index</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="na">index</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="cm">/**
         * Convert a {@code int[]} to {@code DistinctNumber[]}.
         *
         * @param intArray      the {@code int} array want to be converted.
         * @param distinctArray the {@code DistinctNumber} array want
         *                      to be saved into.
         * @return the array after converting.
         */</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="nf">intArrayToDistinctArray</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">intArray</span><span class="o">,</span> <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">distinctArray</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">intArray</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">distinctArray</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DistinctNumber</span><span class="o">(</span><span class="n">intArray</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">distinctArray</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="cm">/**
         * Convert a {@code int[]} to {@code DistinctNumber[]}.
         *
         * @param intArray the {@code int} array want to be converted.
         * @return the array after converting.
         */</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="nf">intArrayToDistinctArray</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">intArray</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">distinctArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DistinctNumber</span><span class="o">[</span><span class="n">intArray</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
            <span class="k">return</span> <span class="nf">intArrayToDistinctArray</span><span class="o">(</span><span class="n">intArray</span><span class="o">,</span> <span class="n">distinctArray</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="cm">/**
         * Convert a {@code DistinctNumber[]} to {@code int[]} .
         *
         * @param distinctArray the {@code DistinctNumber} array want
         *                      to be converted.
         * @param intArray      the {@code int} array want to be saved into.
         * @return the array after converting.
         */</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">distinctArrayToIntArray</span><span class="o">(</span><span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">distinctArray</span><span class="o">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">intArray</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">distinctArray</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">intArray</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">distinctArray</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">valueOf</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">intArray</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="cm">/**
         * Convert a {@code DistinctNumber[]} to {@code int[]} .
         *
         * @param distinctArray the {@code DistinctNumber} array want
         *                      to be converted.
         * @return the array after converting.
         */</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">distinctArrayToIntArray</span><span class="o">(</span><span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">distinctArray</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span><span class="o">[]</span> <span class="n">intArray</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">distinctArray</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
            <span class="k">return</span> <span class="nf">distinctArrayToIntArray</span><span class="o">(</span><span class="n">distinctArray</span><span class="o">,</span> <span class="n">intArray</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Use Hoare partition method to move all the numbers
     * in the array smaller than {@code array[pivot]} to its front,
     * move all the numbers larger than it to its back, and
     * return the final position of the number.
     *
     * @param array a non-empty array wants to be rearranged.
     * @param pivot an integer from {@code 0} to
     *              {@code array.length - 1}, which represents
     *              the position of the pivot.
     * @return an integer from {@code 0} to {@code array.length - 1},
     * which represents the position of the pivot after rearranged.
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">hoarePartition</span><span class="o">(</span><span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">pivot</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>

        <span class="k">while</span> <span class="o">(</span><span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span><span class="o">)</span> <span class="o">{</span>
            <span class="cm">/*
            Find two positions left and right which
            satisfies that array[left] &gt; array[pivot]
            &gt; array[right] and left &lt;= pivot &lt;= right.
             */</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">left</span> <span class="o">&lt;</span> <span class="n">pivot</span> <span class="o">&amp;&amp;</span>
                    <span class="n">array</span><span class="o">[</span><span class="n">left</span><span class="o">].</span><span class="na">compareTo</span><span class="o">(</span><span class="n">array</span><span class="o">[</span><span class="n">pivot</span><span class="o">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">left</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">pivot</span> <span class="o">&amp;&amp;</span>
                    <span class="n">array</span><span class="o">[</span><span class="n">right</span><span class="o">].</span><span class="na">compareTo</span><span class="o">(</span><span class="n">array</span><span class="o">[</span><span class="n">pivot</span><span class="o">])</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">right</span><span class="o">--;</span>
            <span class="o">}</span>

            <span class="cm">/*
            If pivot equals to left or right, which means
            the position of the pivot changes. So we have
            to change the position of the pivot before
            swapping left and right.
             */</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">pivot</span> <span class="o">==</span> <span class="n">left</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">pivot</span> <span class="o">=</span> <span class="n">right</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">pivot</span> <span class="o">==</span> <span class="n">right</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">pivot</span> <span class="o">=</span> <span class="n">left</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="cm">/*
            Swap array[left] and array[right].
             */</span>
            <span class="nc">DistinctNumber</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">array</span><span class="o">[</span><span class="n">left</span><span class="o">];</span>
            <span class="n">array</span><span class="o">[</span><span class="n">left</span><span class="o">]</span> <span class="o">=</span> <span class="n">array</span><span class="o">[</span><span class="n">right</span><span class="o">];</span>
            <span class="n">array</span><span class="o">[</span><span class="n">right</span><span class="o">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">pivot</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * Divide an array into every five integer a piece, extract
     * the median of each copy to the front end of the entire
     * array, copy the front and return it.
     *
     * @param array a non-empty {@code DistinctNumber} array want
     *              to be rearranged.
     * @return a non-empty array, contains the median of each
     * slice.
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="nf">divideIntoFive</span><span class="o">(</span><span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">DistinctNumber</span><span class="o">&gt;</span> <span class="n">mediumList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;&gt;();</span> <span class="c1">// Median of each slice</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">DistinctNumber</span><span class="o">&gt;</span> <span class="n">remainList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;&gt;();</span> <span class="c1">// Numbers other than the median</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">beginSlice</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">beginSlice</span> <span class="o">&lt;</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">beginSlice</span> <span class="o">+=</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Extract a slice.</span>
            <span class="kt">int</span> <span class="n">endSlice</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">beginSlice</span> <span class="o">+</span> <span class="mi">5</span><span class="o">,</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
            <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">slice</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">copyOfRange</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">beginSlice</span><span class="o">,</span> <span class="n">endSlice</span><span class="o">);</span>

            <span class="c1">// Sort the slice and assign each number to each linked list</span>
            <span class="nc">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">slice</span><span class="o">);</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">slice</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">slice</span><span class="o">.</span><span class="na">length</span> <span class="o">/</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">mediumList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">slice</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">remainList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">slice</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="c1">// Copy mediumList and remainList to the array.</span>
        <span class="kt">int</span> <span class="n">indexOfChangedArray</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">DistinctNumber</span> <span class="n">medium</span> <span class="o">:</span> <span class="n">mediumList</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">array</span><span class="o">[</span><span class="n">indexOfChangedArray</span><span class="o">]</span> <span class="o">=</span> <span class="n">medium</span><span class="o">;</span>
            <span class="n">indexOfChangedArray</span><span class="o">++;</span>
        <span class="o">}</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">DistinctNumber</span> <span class="n">remain</span> <span class="o">:</span> <span class="n">remainList</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">array</span><span class="o">[</span><span class="n">indexOfChangedArray</span><span class="o">]</span> <span class="o">=</span> <span class="n">remain</span><span class="o">;</span>
            <span class="n">indexOfChangedArray</span><span class="o">++;</span>
        <span class="o">}</span>

        <span class="c1">// Convert mediumList to array and return.</span>
        <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">mediumArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DistinctNumber</span><span class="o">[</span><span class="n">mediumList</span><span class="o">.</span><span class="na">size</span><span class="o">()];</span>
        <span class="n">mediumList</span><span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="n">mediumArray</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">mediumArray</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * Give an {@code DistinctNumber} array and a number n,
     * rearrange the array to make that for all {@code i &lt; n},
     * {@code array[i] &lt;= array[n]}; for all {@code i &gt; n},
     * {@code array[i] &gt;= array[n]}.
     *
     * @param array a non-empty {@code DistinctNumber} array want
     *              to be rearranged.
     * @param n     an integer from {@code 0} to {@code n - 1}.
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">nthElement</span><span class="o">(</span><span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArrayIndexOutOfBoundsException</span><span class="o">(</span><span class="s">"n cannot "</span> <span class="o">+</span>
                    <span class="s">"greater than the size of array"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// Recursion bounds</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">array</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">array</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="c1">// Get the pivot</span>
        <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">mediumOfSlice</span> <span class="o">=</span> <span class="n">divideIntoFive</span><span class="o">(</span><span class="n">array</span><span class="o">);</span>
        <span class="n">nthElement</span><span class="o">(</span><span class="n">mediumOfSlice</span><span class="o">,</span> <span class="n">mediumOfSlice</span><span class="o">.</span><span class="na">length</span> <span class="o">/</span> <span class="mi">2</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">mediumOfSlice</span><span class="o">.</span><span class="na">length</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">mediumOfSlice</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">array</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">mediumOfSlice</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="n">pivot</span> <span class="o">=</span> <span class="n">hoarePartition</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">pivot</span><span class="o">);</span>

        <span class="c1">// Divide and conquer by pivot</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">pivot</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">leftSide</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">copyOfRange</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">pivot</span><span class="o">);</span>
            <span class="n">nthElement</span><span class="o">(</span><span class="n">leftSide</span><span class="o">,</span> <span class="n">n</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">leftSide</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">leftSide</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="n">pivot</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">rightSide</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">copyOfRange</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">pivot</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
            <span class="n">nthElement</span><span class="o">(</span><span class="n">rightSide</span><span class="o">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">pivot</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">pivot</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">rightSide</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">rightSide</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Give an array and a number n, rearrange the array to make
     * that for all {@code i &lt; n}, {@code array[i] &lt;= array[n]};
     * for all {@code i &gt; n}, {@code array[i] &gt;= array[n]}.
     *
     * @param array a non-empty array want to be rearranged.
     * @param n     an integer from {@code 0} to {@code n - 1}.
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">nthElement</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">DistinctNumber</span><span class="o">[]</span> <span class="n">distinctArray</span> <span class="o">=</span> <span class="nc">DistinctNumber</span><span class="o">.</span><span class="na">intArrayToDistinctArray</span><span class="o">(</span><span class="n">array</span><span class="o">);</span>
        <span class="n">nthElement</span><span class="o">(</span><span class="n">distinctArray</span><span class="o">,</span> <span class="n">n</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> </div> </article> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>let giscusTheme=determineComputedTheme(),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"pufanyi/pufanyi.github.io","data-repo-id":"R_kgDOJnYv-A","data-category":"General","data-category-id":"DIC_kwDOJnYv-M4CW4n7","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Fanyi Pu. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. Last updated: May 01, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?eaf77346e117baa09987a278a117b9a7"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?8d7ebe8276cfa922ec1506a5c6b20c13"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>